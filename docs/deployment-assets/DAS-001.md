---
sidebar_position: 1
---

# GraphDB Deployment guide

## System Requirements

### Supported Platforms

GraphDB is supported on systems with x86_64 and ARM architectures on physical, virtual, or containerized platforms.

## Hardware Requirements
* **CPU**: Should be noted that the license limits the number of CPU cores (This affects inferencing and read requests)
* **Memory**: Please refer to the [hardware sizing documentation](https://graphdb.ontotext.com/documentation/10.2/requirements.html#hardware-sizing)
* **Storage**: A `gp3` or `io` volume is recommended, NFS file systems are not recommended.

## Software Requirements
Java Development Kit 11-16

## Amazon Web Services
### Account and Permissions
Before starting, you need access to an AWS account in which GraphDB will be deployed.
For security reasons, it is recommended that you create an [IAM user](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users.html) 
for the deployment and not use the root account.

### Required resources

You need to be able to create the following resources:

* Virtual Private Cloud (VPC) _(an existing VPC can be used as well)_
* Private subnets
* Public subnets _(if GraphDB will be exposed to the public internet)_
* Auto-scaling groups
* Security groups
* Elastic Cloud Compute (EC2) instances
* Elastic Block Storage (EBS) volumes


### Setup the resources
1. Go to the VPC console and click “Create new VPC”.
   * Select “VPC and More”.
   * Enter a name for your VPC in the "Name tag auto-generation" field. 
     This name will also serve as the base Name tag for other associated resources.
   * If needed, modify the value for the "IPv4 CIDR block" field.
   * Choose "3" for the "Number of Availability Zones (AZs)".
   * Select "3" for the "Number of public subnets" if you plan to expose GraphDB to the public internet. _(Optional)_
   * Choose "3" for the "Number of private subnets".
   * Customize the CIDR blocks for the subnets if necessary.
   * Select "1 per AZ" for "NAT gateways". _(note that there is a charge per NAT gateway)_
   * Choose "None" for "VPC endpoints".
   * Under “DNS Options”, make sure “Enable DNS hostnames” and “Enable DNS resolution” are enabled.
2. Go to the EC2 console.
3. Click “Launch Templates” from the side menu.
4. Click “Create launch template”.
   * Enter a desired name for the launch template in the "Launch template name" field.
   * Enable the option "Provide guidance to help me set up a template that I can use with EC2 Auto Scaling".
   * Under "Application and OS Images", click on "Quick Start" and select "Ubuntu".
     * Select “Ubuntu Server 22.04”, SSD Volume Type.
     * Select "64-bit (x86)" for the architecture.
   * Choose the desired instance type under "Instance Type". Refer to the [sizing page](../sizing/SIZ-001) 
     for information on system resource recommendations.
     * We recommend “memory optimized” instances.
     * For a repository containing up to 1 billion statements we recommend `r6i.2xlarge`.
   * Add or Create a “Key Pair” if needed.
   * Under “Network Settings”, choose “Create Security Group”.
     * Provide a name and description for the security group.
     * Choose the VPC from step 1.
     * Click on “Add security group rule”.
       * Enter 7200 for the "Port range".
       * Select all three private subnet CIDR blocks for the "Source".
     * Click on “Add security group rule” and repeat the steps above, but this time enter 7300 for the "Port range".
   * Under "Storage", click on "Add new volume". Keep in mind that you'll need at least double the estimated size to account for replication or backup processes.
     * Size: 100 (Refer to the [sizing page](../sizing/SIZ-001) for a more accurate estimate)
     * Device name: /dev/sdf
     * Type: gp3
     * IOPS: 16000
   * Provide a "user data" script under "Additional Details" to install and run GraphDB.
   * Click on “Create launch template”.
5. Go to “Auto Scaling” and click “Create Auto Scaling group”.
   * Provide a name for the Auto Scaling group.
   * Select the recently created launch template under the "Launch Template" section, and then proceed by clicking "Next".
   * Under “VPC”, select you VPC.
   * Select all three private subnets under the "Availability Zones and subnets" section, and proceed by clicking "Next".
   * Enter "3" for the Desired, Minimum, and Maximum capacity in the "Group Size" field.
6. Go to “Target Groups” and click on “Create target group”.
   * For “Target type”, choose “Instances”
   * Provide a name for the group
   * Set the protocol to "HTTP"
   * Specify the port as "7200"
   * Select the VPC you created earlier from the dropdown menu.
   * In the "Health checks" section, modify the "Health check path" to "/rest/cluster/node/status", and proceed by clicking "Next".
   * Select all available instances
   * Enter "7200" under "Ports for the selected instances", and click on "Include as pending below"
7. Go to “Load Balancers” and click on “Create load balancer”.
   * Choose “Network Load Balancer”.
   * Providee a name for the load balancer.
   * Select the desired scheme.
     * If you select “Internet-facing”, the security group for the instances must be updated with the public subnet CIRD block, but only for port 7200
   * Select your VPC from the available options
   * Choose all three availability zones:
     * For an internet-facing load balancer, select the public subnets.
     * For an internal load balancer, select the private subnets.
   * In the "Listeners and routing" section:
     * Change the port to 7200.
     * Select the target group, which was just created

## Installing GraphDB on EC2 
Before installing GraphDB, make sure the EC2 instance meets the System Requirements.

**Install GraphDB from the standalone distribution archive**

GraphDB requires a Java Development Kit (JDK) to be installed. The recommended version is 11, but anything prior to version 17 should work as well.

[Register](https://www.ontotext.com/products/graphdb/download/), download and unzip the GraphDB distribution in the EC2 instance.

```shell
$ unzip graphdb-10.2.2-dist.zip
```

Move it to `/opt` and create a symlink to it:
```shell
$ mv graphdb-10.2.2 /opt/
$ ln -s /opt/graphdb-10.2.2 /opt/graphdb
```

Create a user and group for GraphDB and give it permissions on the installation directory:
```shell
$ groupadd graphdb
$ useradd -g graphdb graphdb -s /bin/bash
$ chown -R graphdb:graphdb /opt/graphdb-10.2.2
```

**Running as a console application:**
```shell
/opt/graphdb/bin/graphdb
```

Or to run it in the background, use:
```shell
/opt/graphdb/bin/graphdb -b
```

GraphDB should now be accessible on the public IP of the EC2 instance at port `7200`.
_(If you don't have a public IP, you can create a VPN connection)_

To stop GraphDB, press `CTRL + C`, if you have started it in the foreground, otherwise, you can execute the following command:
```shell
/opt/graphdb/bin/graphdb stop
```

**Running as systemd service**

GraphDB can be configured to be managed by systemd and also to start automatically when the system starts.

Create the file `/lib/systemd/system/graphdb.service`

```shell
[Unit]
Description="GraphDB Engine"
Wants=network-online.target
After=network-online.target

[Service]
Restart=on-failure
RestartSec=5s
User=graphdb
Group=graphdb
ExecStart="/opt/graphdb/bin/graphdb"
TimeoutSec=120
SuccessExitStatus=143

[Install]
WantedBy=multi-user.target
```

Reload systemd, to pick the GraphDB unit file:
```shell
$ systemctl daemon-reload
```

Enable the service to run at system start up:
```shell
$ systemctl enable graphdb
```

Start the GraphDB service:
```shell
$ systemctl start graphdb
```

Check its status:
```shell
$ systemctl status graphdb
```





